{
  "creator_user_name": "#{DATABRICKS_CLIENT_ID}#",
  "run_as_user_name": "#{DATABRICKS_CLIENT_ID}#",
  "run_as_owner": true,
  "settings": {
    "name": "#{DATABRICKS_ENVIRONMENT_LOWER}#_#{DATABRICKS_JOB_RECEITA_FEDERAL_JOB_NAME}#_job",
    "description": "#{DATABRICKS_JOB_RECEITA_FEDERAL_JOB_DESCRIPTION}#",
    "email_notifications": {
      "no_alert_for_skipped_runs": false
    },
    "webhook_notifications": {
      "on_start": [
        {
          "id": "#{DATABRICKS_SLACK_WEBHOOK}#"
        }
      ],
      "on_success": [
        {
          "id": "#{DATABRICKS_SLACK_WEBHOOK}#"
        }
      ],
      "on_failure": [
        {
          "id": "#{DATABRICKS_SLACK_WEBHOOK}#"
        }
      ],
      "on_duration_warning_threshold_exceeded": [
        {
          "id": "#{DATABRICKS_SLACK_WEBHOOK}#"
        }
      ]
    },
    "notification_settings": {
      "no_alert_for_skipped_runs": false,
      "no_alert_for_canceled_runs": false
    },
    "timeout_seconds": 2400,
    "health": {
      "rules": [
        {
          "metric": "RUN_DURATION_SECONDS",
          "op": "GREATER_THAN",
          "value": 1200
        }
      ]
    },
    "schedule": {
      "quartz_cron_expression": "#{DATABRICKS_JOB_RECEITA_FEDERAL_JOB_SCHEDULE_CRON}#",
      "timezone_id": "America/Sao_Paulo",
      "pause_status": "#{DATABRICKS_JOB_RECEITA_FEDERAL_JOB_SCHEDULE_STATUS}#"
    },
    "max_concurrent_runs": 1,
    "tasks": [
      {
        "task_key": "#{DATABRICKS_ENVIRONMENT_LOWER}#_#{DATABRICKS_JOB_RECEITA_FEDERAL_TASK_1_NAME}#_task",
        "run_if": "ALL_SUCCESS",
        "notebook_task": {
          "notebook_path": "#{DATABRICKS_JOB_RECEITA_FEDERAL_TASK_1_PATH}#",
          "base_parameters": {
            "environment_task": "#{DATABRICKS_ENVIRONMENT_LOWER}#"
          },
          "source": "WORKSPACE"
        },
        "job_cluster_key": "#{DATABRICKS_JOB_RECEITA_FEDERAL_JOB_CLUSTER_NAME}#_cluster",
        "max_retries": 1,
        "min_retry_interval_millis": 900000,
        "retry_on_timeout": true,
        "timeout_seconds": 1800,
        "health": {
          "rules": [
            {
              "metric": "RUN_DURATION_SECONDS",
              "op": "GREATER_THAN",
              "value": 900
            }
          ]
        },
        "email_notifications": {},
        "notification_settings": {
          "no_alert_for_skipped_runs": false,
          "no_alert_for_canceled_runs": false,
          "alert_on_last_attempt": false
        },
        "webhook_notifications": {
          "on_start": [
            {
              "id": "#{DATABRICKS_SLACK_WEBHOOK}#"
            }
          ],
          "on_success": [
            {
              "id": "#{DATABRICKS_SLACK_WEBHOOK}#"
            }
          ],
          "on_failure": [
            {
              "id": "#{DATABRICKS_SLACK_WEBHOOK}#"
            }
          ],
          "on_duration_warning_threshold_exceeded": [
            {
              "id": "#{DATABRICKS_SLACK_WEBHOOK}#"
            }
          ]
        }
      },
      {
        "task_key": "#{DATABRICKS_ENVIRONMENT_LOWER}#_#{DATABRICKS_JOB_RECEITA_FEDERAL_TASK_2_NAME}#_task",
        "depends_on": [
          {
            "task_key": "#{DATABRICKS_ENVIRONMENT_LOWER}#_#{DATABRICKS_JOB_RECEITA_FEDERAL_TASK_1_NAME}#_task"
          }
        ],
        "run_if": "ALL_SUCCESS",
        "notebook_task": {
          "notebook_path": " #{DATABRICKS_JOB_RECEITA_FEDERAL_TASK_2_PATH}#",
          "source": "WORKSPACE"
        },
        "job_cluster_key": "#{DATABRICKS_JOB_RECEITA_FEDERAL_JOB_CLUSTER_NAME}#_cluster",
        "max_retries": 1,
        "min_retry_interval_millis": 3600000,
        "retry_on_timeout": false,
        "timeout_seconds": 1200,
        "health": {
          "rules": [
            {
              "metric": "RUN_DURATION_SECONDS",
              "op": "GREATER_THAN",
              "value": 600
            }
          ]
        },
        "email_notifications": {},
        "notification_settings": {
          "no_alert_for_skipped_runs": false,
          "no_alert_for_canceled_runs": false,
          "alert_on_last_attempt": false
        },
        "webhook_notifications": {
          "on_start": [
            {
              "id": "#{DATABRICKS_SLACK_WEBHOOK}#"
            }
          ],
          "on_success": [
            {
              "id": "#{DATABRICKS_SLACK_WEBHOOK}#"
            }
          ],
          "on_failure": [
            {
              "id": "#{DATABRICKS_SLACK_WEBHOOK}#"
            }
          ],
          "on_duration_warning_threshold_exceeded": [
            {
              "id": "#{DATABRICKS_SLACK_WEBHOOK}#"
            }
          ]
        }
      }
    ],
    "job_clusters": [
      {
        "job_cluster_key": "#{DATABRICKS_JOB_RECEITA_FEDERAL_JOB_CLUSTER_NAME}#_cluster",
        "new_cluster": {
          "cluster_name": "#{DATABRICKS_JOB_RECEITA_FEDERAL_JOB_CLUSTER_NAME}#_cluster",
          "spark_version": "13.3.x-scala2.12",
          "azure_attributes": {
            "first_on_demand": 1,
            "availability": "SPOT_WITH_FALLBACK_AZURE",
            "spot_bid_max_price": -1
          },
          "node_type_id": "#{DATABRICKS_JOB_RECEITA_FEDERAL_JOB_CLUSTER_NODE_TYPE}#",
          "driver_node_type_id": "#{DATABRICKS_JOB_RECEITA_FEDERAL_JOB_CLUSTER_DRIVER_TYPE}#",
          "spark_env_vars": {
            "PYSPARK_PYTHON": "/databricks/python3/bin/python3",
            "ENVIRONMENT_CLUSTER": "#{DATABRICKS_ENVIRONMENT_LOWER}#"
          },
          "enable_elastic_disk": true,
          "data_security_mode": "SINGLE_USER",
          "runtime_engine": "PHOTON",
          "autoscale": {
            "min_workers": #{DATABRICKS_JOB_RECEITA_FEDERAL_JOB_CLUSTER_AUTOSCALE_MIN_WORKER}#,
            "max_workers": #{DATABRICKS_JOB_RECEITA_FEDERAL_JOB_CLUSTER_AUTOSCALE_MAX_WORKER}#
          }
        }
      }
    ],
    "tags": {
      "params1_job": "testeeee"
    },
    "format": "MULTI_TASK",
    "parameters": [
      {
        "name": "environment_param_job",
        "default": "#{DATABRICKS_ENVIRONMENT_LOWER}#"
      }
    ]
  }
}